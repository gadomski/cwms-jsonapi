{"name":"cwms-jsonapi","tagline":"Documentation for a CWMS JSON API","body":"### Welcome to _a_ CWMS JSON API.\r\n\r\nThis is the documentation for _a_ (not _the_) JSON API for the [Corps Water Management System](https://cwms.usace.army.mil), or **CWMS**.\r\nThis is **not** the API code itself.\r\nAt the time of this writing, the API code is available only on the server located at `155.78.180.103` in the `cwmsweb` schema.\r\nThis document only describes the data provided by the API.\r\n\r\n### Schema\r\n\r\nAll data is received as JSON.\r\n\r\n```\r\n$ curl -i http://nae-rrs2.usace.army.mil:7777/pls/cwmsweb/jsonapi.locations?db_office_id=FOO\r\nHTTP/1.1 200 OK\r\nDate: Tue, 03 Jun 2014 20:09:24 GMT\r\nServer: Oracle-Application-Server-11g\r\nX-DB-Content-length: 2\r\nContent-Length: 2\r\nContent-Type: application/json\r\nContent-Language: en\r\n\r\n[]\r\n```\r\n\r\nBlank fields are included as `null` instead of being omitted.\r\n\r\nAll timestamps are returned in ISO 8601 format:\r\n\r\n```\r\nYYYY-MM-DDTHH:MM:SSZ\r\n```\r\n\r\n\r\n### URL Structure\r\n\r\nDue to the idiosyncrasies of [mod_plsql](http://docs.oracle.com/cd/B14099_19/web.1012/b14010/using.htm), **cwms-jsonapi** eschews traditional API behavior in favor of easy integration with existing PL/SQL web packages. Consequentially, an API call might look like:\r\n\r\n```\r\nhttp://nae-rrs2.usace.army.mil:7777/pls/cwmsweb/jsonapi.locations?db_office_id=NAE\r\n```\r\n\r\nWhere everything after `http://nae-rrs2.usace.army.mil:7777/pls/cwmsweb/jsonapi` is used to query the API. the `GET` parameters in the URL are passed as procedure arguments in the PL/SQL backend, so misspelling `GET` parameter names will produce `404` with error messages that look suspiciously internally generated (its because they are).\r\n\r\nIn this documentation, urls are listed with a dot, then the resource name, then the parameters, for example, if your base API url is `http://example.com/pls/cwmsweb/jsonapi`, then the URL for a list of locations would be:\r\n\r\n```\r\n.locations?db_office_id=MYOFFICE\r\n```\r\n\r\n\r\n### HTTP Verbs\r\n\r\nThe API only accepts `GET` requests.\r\n\r\n\r\n### Locations\r\n\r\n**Locations** are field sites that may contain one or more sensors, some of which may produce time series data. To get a list of locations, query:\r\n\r\n```\r\n.locations?db_office_id=OFFICE_ID\r\n```\r\n\r\n#### Parameters\r\n\r\n* **db_office_id**: [string, required] The office id, e.g. 'NAE'\r\n* **unit_system**: [string] A given location usually has two database representations, one for each unit system ('SI' or 'EN'), default 'SI'\r\n\r\n#### Response\r\n\r\n```json\r\n[\r\n  {\r\n    \"active_flag\": \"T\",\r\n    \"db_office_id\": \"NAE\", \r\n    \"elevation\": 102.12,\r\n    \"longtitude\": -72.6219,\r\n    \"latitude\": 42.3108,\r\n    \"location_id\": \"NOR\",\r\n    \"location_type\": \"Pool Gage\",\r\n    \"long_name\": \"Connecticut River at North Hampton, MA\",\r\n    \"state_initial\": \"MA\",\r\n    \"time_zone_name\": \"US/Eastern\",\r\n    \"unit_id\": \"m\",\r\n    \"unit_system\": \"SI\"\r\n  }\r\n]\r\n```\r\n\r\n\r\n### Location\r\n\r\nTo query a single location:\r\n\r\n```\r\n.locations?location_id=LOCATION_ID\r\n```\r\n\r\nAt the time of this writing, the returned data for a single location has the same format of a single entry in the `locations` array, returned above.\r\n\r\n### Timeseries\r\n\r\nTo query for information about all **timeseries** for a given location:\r\n\r\n```\r\n.timeseries?location_id=LOCATION_ID\r\n```\r\n\r\n#### Response\r\n\r\n```json\r\n[\r\n  {\r\n    \"cwms_ts_id\": \"HUB.Stage-ICE7.Inst.6Hours.0.DCP-raw\",\r\n    \"db_office_id\": \"NAE\",\r\n    \"location_id\": \"HUB\",\r\n    \"parameter_id\": \"Stage-ICE7\",\r\n    \"ts_code\": 8578021,\r\n    \"unit_id\": \"m\"\r\n  }\r\n]\r\n```\r\n\r\n\r\n###  Timeseries Data\r\n\r\nTo retrieve timeseries data from a given location:\r\n\r\n```\r\n.timeseriesdata?ts_code=TS_CODE\r\n```\r\n\r\n#### Response\r\n\r\n```json\r\n[\r\n  {\r\n    \"date_time\": \"2007-06-01T00:00:00\",\r\n    \"quality_code\": 0,\r\n    \"ts_code\": 8578021,\r\n    \"value\": 489.31999999999999\r\n  }\r\n]\r\n```","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}